<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEEP-SYNC</title>
    <link rel="stylesheet" href="style.css">
    <style>
        input[type="range"] {
            width: 40rem;
            margin: 20px 0;
        }

        #selectedNumber {
            font-size: 20px;
        }
    </style>
</head>

<body>
    <ul style="width: 100%;height: 100%">
        <li id="slide1">
            <div id="content">
                <h1 id="title">DEEP-SYNC</h1>
                <p id="description">DEEP-SYNC is a program which allows you to figure out the similarity of two
                    different videos.<br>
                    It can be used on various fields whenever comparing two postures are required.</p>
                <button id="start_button" onclick="scroll_down()">START</button>
            </div>
        </li>
        <li id="slide2" style="width: 100%;height: 100%">
            <button id="top_button" onclick="scroll_up()">TOP</button>
            <h1 id="upload_files">Upload Video</h1>
            <div id="video_load"
                style="width: 35rem;display: flex; align-items: center; justify-content: space-between;">
                <form id="form" action="/upload_videos/" method="post" enctype="multipart/form-data">
                    <div style="display: flex; width: 35rem; justify-content: space-between;">
                        <label id="video_file_label" for="video_file">
                            <div id="video_file_name">Click to upload file</div>
                        </label>
                        <input type="file" name="file" id="video_file" accept="video/*" required
                            onchange="updateFileName()">
                        <label id="video_file_label" for="video_file2">
                            <div id="video_file_name">Click to upload file</div>
                        </label>
                        <input type="file" name="file2" id="video_file2" accept="video/*" required
                            onchange="updateFileName2()">
                    </div>
                </form>
            </div>
            <input type="range" id="numberSelector" min="0.0" max="0.5" value="0.0" step="0.1">
            <div id="selectedNumber">Select Period: 0.0</div>
            <button id="submit_button" type="submit" onclick="submit_clicked(); submitUserInput()">Submit</button>
        </li>
    </ul>
    <script src="script.js">
    </script>
    <script>
        var numberSelector = document.getElementById('numberSelector');
        var selectedNumberDisplay = document.getElementById('selectedNumber');
        var savedNumber;

        // 드래그바 값 변경 시 호출되는 함수
        function updateSelectedNumber() {
            var selectedNumber = numberSelector.value;
            selectedNumberDisplay.textContent = 'Select Period: ' + selectedNumber;
        }

        // 버튼 클릭 시 호출되는 함수
        function saveSelectedNumber() {
        }

        // 초기 값 설정
        updateSelectedNumber();

        // 드래그바 값 변경 이벤트에 함수 연결
        numberSelector.addEventListener('input', updateSelectedNumber);


        function submitUserInput() {
            savedNumber = numberSelector.value;
            var formData = new FormData();
            formData.append('key3', savedNumber);

            // AJAX를 사용하여 사용자 입력을 서버로 전송
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/process_user_input/', true);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');

            // 서버의 응답을 처리할 콜백 함수 정의
            xhr.onreadystatechange = function () {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status === 200) {
                        // 서버 응답을 받아와서 동적으로 화면에 표시
                        var responseDiv = document.getElementById('gpt3ResponseDiv');
                        responseDiv.style.display = 'block';  // 결과를 표시할 div를 보이도록 변경
                        document.getElementById('gpt3Response').innerHTML = xhr.responseText;
                    } else {
                        console.error('에러:', xhr.status);
                    }
                }
            };

            // 데이터를 서버로 전송
            xhr.send(new URLSearchParams(formData));
        }


    </script>
</body>

</html>